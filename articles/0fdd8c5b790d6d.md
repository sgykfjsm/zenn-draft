---
title: TiDBのSEQUENCEをアプリケーションで使う
emoji: ⚒️
type: tech
topics:
  - database
  - tidb
  - go
  - python
  - django
published: false
---
## この記事について

これまでTiDBのSEQUENCEオブジェクトについて2回に渡って解説してきました。

https://zenn.dev/shigeyuki/articles/bf113e5e5d5846

https://zenn.dev/shigeyuki/articles/e21de4444546cd

この記事では最終回として、SEQUENCEオブジェクトをアプリケーションで扱うにあたって実装例や注意点を見ていきたいと思います。上記２記事に加えて、本記事を読むことによってTiDBでSEQUENCEオブジェクトを扱うにあたって準備万全と言えるようになることを目指します。SEQUENCEオブジェクトについては上記２記事を参照してください。

## ORMやフレームワークでの対応状況

SEQUENCEオブジェクトをアプリケーションで扱う際には、利用するORMやアプリケーションフレームワークでの対応状況を確認する必要があります。全てのORMなどを対象に確認することが難しいため、ここでは筆者の独断で以下の４つに絞って調べました。
- Python
	- SQLAlchemy: YES https://docs.sqlalchemy.org/en/14/core/defaults.html#sqlalchemy.schema.Sequence
	- 
- Go

## 実装例

早速アプリケーションでの実装を見ていきましょう。以下のユースケースを想定します。
### シンプル構成での SEQUENCE を扱う

### ORM モデリングで SEQUENCE を扱う

### AUTO_INCREMENT と同等の使用感を実現するテクニック

    
## トランザクションとリトライ戦略
    
### ロールバック時の欠番発生の落とし穴
        
### nextval() 呼び出しの再試行フロー
        
### 固定待機／指数バックオフのサンプル
        
### 差分で見るコード例
        
    
## まとめ